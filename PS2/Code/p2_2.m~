close all; clc;

%[x,y]=meshgrid(-2:0.2:3.5, -2:0.2:3.5);
syms x y;
f1 = 2*x+3*y+1;
f2 = x.^2+y.^2-x.*y-5;
f3 = (x-5)*cos(y-5)-(y-5)*sin(x-5);

g1 = gradient(f1,[x,y]);
g2 = gradient(f2,[x,y]);
g3 = gradient(f3,[x,y]);

h1 = hessian(f1,[x,y]);
h2 = hessian(f2,[x,y]);
h3 = hessian(f3,[x,y]);

%%%%%Approximatino for f1
V = [x,y]';
V0 = [1,0]';
f1_v0 = subs(f1,[x,y],[1,0]);
g1_v0 = subs(g1,[x,y],[1,0]);
h1_v0 = subs(h1,[x,y],[1,0]);

f1_approx = f1_v0 + g1_v0'*(V-V0) + 0.5*(V-V0)'*h1_v0*(V-V0);
ezsurf(x,y,f1);
hold on
ezsurf(x,y,f1_approx);

function plotTangentPlane(x,y,f,g,h,subPlotInd)
subplot(1,3,subPlotInd);
V = [x,y]';
V0 = [1,0]';

ezsurf(x,y,f1);
hold on
ezsurf(x,y,f1_approx);

xlabel('x');
ylabel('y');
zlabel('z');
end
